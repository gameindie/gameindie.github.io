
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	
	<title>React.js - Redux - Router 튜토리얼</title>
    
	
	<meta name="author" content="Maz">
	
	<link rel="stylesheet" href="/assets/themes/Snail/css/jquery.fancybox.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/main.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/pages/journal.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/team.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/static.css">
	<link rel="stylesheet" href="/assets/themes/Snail/css/errors.css">
	<link rel="stylesheet" href="/assets/themes/Snail/google-code-prettify/prettify.css">
	
	<link rel="shortcut icon" href="/assets/themes/Snail/img/favicon.ico">
	
	<script type="text/javascript" src="/assets/themes/Snail/js/jquery.min.js"></script>
	
	<script type="text/javascript" src="/assets/themes/Snail/js/auto_loadmore.js"></script>
	
	<script type="text/javascript" src="/assets/themes/Snail/google-code-prettify/prettify.js"></script>
	
	<script type="text/javascript">
	  $(function(){
		$("pre code").addClass("prettyprint linenums");
		prettyPrint();
	  });
	</script>
	
<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
</head>
<body>
	<noscript>
		&amp;lt;div id="no-js"&amp;gt;Please enable JavaScript in your browser to experience / fully&amp;lt;/div&amp;gt;
	</noscript>
    <div id="page-container">
		<div>
			<nav>
	<div id="nav-l">
	</div>
	<div id="nav-c">
		<ul id="nav-list" style="width: 700px;">
			<li id="home"><a href="/">Home</a></li>
			
			
			
				
				  
				
			 
				
				  
					
					<li id = "About Me"><a href="/about.html">About Me</a></li>
					
				  
				
			 
				
				  
					
					<li id = "Archive"><a href="/archive.html">Archive</a></li>
					
				  
				
			 
				
				  
				
			 
				
				  
					
					<li id = "Categories"><a href="/categories.html">Categories</a></li>
					
				  
				
			 
				
				  
				
			 
				
			 
				
				  
				
			 
				
				  
				
			 
				
			 
				
				  
				
			 
				
			 
				
				  
					
					<li id = "Tags"><a href="/tags.html">Tags</a></li>
					
				  
				
			 
			
			
		</ul>
		<form id="nav-search" method="GET" action="/search.html">
			<div id="search-right-pix">
				<div id="search-left-pix">
					<div id="search-center-pix">
						<div id="search-icon-pix"></div>
						<input name="query" type="text" placeholder="Search">
					</div>
				</div>
			</div>
		</form>
		
		
	</div>
	<div id="nav-r">
	</div>
</nav>
			<div id="page-content">
				
<div id="page-content">
	<div class="cont932">
	<div id="journal-articles-block">
		<div class="journal-article">
			<div class="journal-post-info">
				<div class="journal-cat-box">
				
				
				<div class="journal-cat-box">

<a href="/categories.html#web-ref" title="web">
	web

</a>
</div>
				
				</div>
			</div>
			<div class="journal-body">
				<h1 class="journal-title">React.js - Redux - Router 튜토리얼<span class="author"></span>
				</h1>
				<span class="the-article">
				<p>React에 Redux, React에 Router 를 각각 붙이는 것은 어렵지 않습니다. 하지만 세 개를 동시에 붙여보면 잘 안되기도하고, 여기저기 예제들도 다 달라서 어려움이 많습니다.</p>

<p>가장 큰 문제는 React-Router가 현재 0.13버전이 npm 에 등록되어있고, React 1.0 대응버전이 베타로 나와있기 때문입니다. 대부분의 예제는 1.0.0-beta3으로 되어있어서, 자료를 찾는데 어려움이 많았는데, 중간중간 버전에 따라 정리해보았습니다.</p>

<p>(본 예제는 redux-react-router 라이브러리와 상관없는 내용입니다. React, Redux, React-Router를 동시에 사용하는 방법에대한 내용입니다.)</p>

<ol>
  <li>React-Router
    <ol>
      <li>설치
        <ul>
          <li>0.13 버전
            <ul>
              <li><code>npm install --save react-router</code></li>
            </ul>
          </li>
          <li>1.0.0-beta3
            <ul>
              <li><code>npm intsall --save react-router@1.0.0-beta3</code></li>
            </ul>
          </li>
        </ul>
      </li>
      <li>components폴더 생성
        <ul>
          <li>
            <p>App.js 작성 ( route root )</p>

            <pre><code>  'use strinct';
			
  import React from 'react';
  import {RouteHandler} from 'react-router';
			
  class App extends React.Component {
      render() {
          return (
              &lt;div&gt; &lt;RouteHandler/&gt; &lt;/div&gt;
          )
      }
  }
			
  export default App;
</code></pre>
          </li>
          <li>
            <p>HelloWorld.js작성 ( default route )</p>

            <pre><code>  'use strict';
			
  import React from 'react';
			
  class HelloWorld extends React.Component {
      render() {
      	return (
         	&lt;div&gt; Hello World! &lt;/div&gt;
         )
      }
  }
			
  export default HelloWorld;
</code></pre>
          </li>
          <li>
            <p>Route.js 작성 ( route 내용 작성 )</p>

            <ul>
              <li>
                <p>0.13</p>

                <pre><code>  'use strict';
				
  import {App, HelloWorld} from './index';
  import {DefaultRoute, Route} from 'react-router';
  import React from 'react';
				
  export default (
      &lt;Route handler = {App} path = '/'&gt;
          &lt;DefaultRoute handler={HelloWorld}/&gt;
      &lt;/Route&gt;
  );
</code></pre>
              </li>
              <li>
                <p>1.0.0 beta ( context 이슈 때문에, 반드시 함수로 리턴해야한다. )</p>

                <pre><code>  'use strict';
				
  import {App, HelloWorld} from './index';
  import React from 'react';
  import {Router, Route} from 'react-router';
				
  function RouteWrapper(history) {
      return (
          &lt;Router history={history}&gt;
              &lt;Route component={App}&gt;
                  &lt;Route path="/" component={HelloWorld} /&gt;
              &lt;/Route&gt;
          &lt;/Router&gt;
      );
  };
				
  export default RouteWrapper;
</code></pre>
              </li>
            </ul>
          </li>
          <li>
            <p>index.js 작성 ( components폴더를 require 했을 때, export할 모듈리스트 )</p>

            <pre><code>  'use strict';
			
  export {default as App} from './App';
  export {default as HelloWorld} from './HelloWorld';
  // (0.13)
  export {default as Route} from './Route';
  // (1.0.0)
  export {default as RouteWrapper} from './Route';
</code></pre>
          </li>
        </ul>
      </li>
      <li>entry에 router 설정
        <ul>
          <li>0.13 은 Router.run을 사용하고, 1.0.0 은 React.render를 직접호출하되, Router 컴포넌트를 사용하는 것이 다르다.</li>
          <li>
            <p>Router 컴포넌트에 history를 넣어주지않으면 <code>Uncaught Error: Invariant Violation: Server-side &lt;Router&gt;s need location, branch, params, and components props. Try using Router.run to get all the props you need</code> 과 같은 에러가 난다.</p>

            <pre><code>  'use strict';
			
  import React from 'react';
  // (0.13)
      import {Route} from './components';
      import Router from 'react-router';
  // (1.0.0)beta
      import BrowserHistory from 'react-router/lib/BrowserHistory'
      import {RouteWrapper} from './components';
						
  // (0.13)
      Router.run(Route, (Handler) =&gt; {
          React.render(&lt;Handler/&gt;
          , document.getElementById('app'));
      })
			
  // (1.0.0) beta
      const history = new BrowserHistory();
      React.render(
          RouteWrapper(history)
    		, document.getElementById('app')
    	);
</code></pre>
          </li>
        </ul>
      </li>
      <li>Hello World 출력확인</li>
    </ol>
  </li>
  <li>Redux with React.js
    <ol>
      <li>설치
        <ul>
          <li><code>npm install --save react-redux</code></li>
        </ul>
      </li>
      <li>React-Redux 주요 키워드
        <ol>
          <li>
            <p>Provider 컴포넌트</p>

            <pre><code> &lt;Provider store={store}&gt;
     {() =&gt; Root 컴포넌트 }
 &lt;/Provider&gt;
</code></pre>

            <ul>
              <li>항상 Root 컴포넌트를 wrapping 하고 있어야함.</li>
              <li>이 컴포넌트로 Wrapping 하면, 자식~리프 자식들까지 context로써 전달된 redux-store에 접근가능함.</li>
              <li>현재는 react 0.13의 컨텍스트 이슈때문에 child를 함수로 가져야한다. 0.14부터는 이러지 않아도 될 것이다.</li>
              <li>컴포넌트에 contextType를 세팅하면, store접근가능 한 것 확인함.</li>
              <li>context자체는 undocumented feature임.</li>
              <li>contextType을 이용해 store에 직접접근할 수 있지만, connect 함수/데코레이터를 이용해 컴포넌트에 노출시키고 싶은 변수만 노출 시키거나, dispatch를 하거나 하는 것이 가능하다.</li>
            </ul>
          </li>
          <li>
            <p>connect</p>

            <pre><code> // dispatch만 props에 add
 export default connect()(컴포넌트이름)
 // state에있는 변수를 현 컴포넌트.props에 expose ( subscribe 됨 )
 export default connect(state=&gt;{ return { value:state.value }; })(컴포넌트이름)
</code></pre>

            <ul>
              <li>component와, redux store를 연결함. ( 내부적으로 Provider에서 넘겨준 store를 context를 이용하여 사용한다는 것임 )</li>
              <li>store의 dispatch function을 컴포넌트의 props에 add시켜줌.</li>
              <li>dumb컴포넌트를 smart컴포넌트로 바꾸는 중요키워드
                <ul>
                  <li>참고 : https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0</li>
                </ul>
              </li>
              <li>decorator, 함수 형태로 제공된다.</li>
              <li>decorator는 experimental이다.</li>
            </ul>
          </li>
        </ol>
      </li>
      <li>Redux 붙이기 ( redux 는 react-redux 에서 dependency로 설치된다 )
        <ol>
          <li>Reducer, Store 생성
            <ul>
              <li>기본적으로 이전 포스트를 참고하면 됨.</li>
              <li>튜토리얼 따라하시는 분을 위해 test용 reducer, store 첨부
                <ul>
                  <li>
                    <p>entry.js</p>

                    <pre><code>  import {createStore} from 'redux';
  function testReducer(state = {}, action) {
      switch (action.type) {
          default:
              return state;
      }
  }
					
  const store = createStore(testReducer);
</code></pre>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>Provider 컴포넌트 추가
            <ul>
              <li>RootComponent 를 Wrapping 하는 Provider 컴포넌트를 만들고, store를 던져주면 완성이다.</li>
              <li>RootComponent란 별게 아니고, 자신의 App에 최상단 컴포넌트를 말하는데, 사실 위치는 상관이없고, context가 필요한 컴포넌트 상단에 있기만 하면 된다.</li>
              <li>
                <p>(중요) Provider 컴포넌트의 child인 Root Component는 현재(React 0.13) function형태로 들어가야한다! 그래야 컴포넌트에서 store를 사용할 수 있다. 0.14부터는 이렇게 사용안해도 될 것이라고 예상한다고 한다.</p>

                <ul>
                  <li>0.13</li>
                  <li>
                    <p>만약, Routing이 잘 안된다면 https://github.com/rackt/react-redux -&gt; readme파일에서 routerState로 검색해서, routerState를 Handler 컴포넌트의 prop으로 넣어주면 된다.</p>

                    <pre><code>  import {Provider} from 'react-redux';
  Router.run(Route, (Handler) =&gt; {
      React.render(
      &lt;Provider store={store}&gt;
      	{() =&gt; &lt;Handler/&gt; }
      &lt;/Provider&gt;
      , document.getElementById('app'));
  })				
</code></pre>
                  </li>
                  <li>
                    <p>1.0.0 beta3</p>

                    <pre><code>  import {Provider} from 'react-redux';
  React.render(
      &lt;Provider store={store}&gt;
          {() =&gt; RouteWrapper(history) }
      &lt;/Provider&gt;
      , document.getElementById('app')
  );
</code></pre>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li>Hello World 컴포넌트를 Smart하게 만들자.
            <ul>
              <li>
                <p>components/HelloWorld.js</p>

                <pre><code>  'use strict';
				
  import React from 'react';
  import {connect} from 'react-redux';
				
  class HelloWorld extends React.Component {
      render() {
          const {dispatch, state} = this.props;
          console.log(dispatch);
          console.log({state});
          return (
              &lt;div&gt;Hello World!&lt;/div&gt;
          )
      }
  }
  export default connect(state =&gt; { return ( { state: state } ); })(HelloWorld);
</code></pre>
              </li>
              <li>console.log 로, dispatch, state를 사용할 수 있음을 볼 수 있다.</li>
              <li>이제 필요한 기능을 Redux를 사용하여 구현할 수 있을 것이다.</li>
            </ul>
          </li>
        </ol>
      </li>
    </ol>
  </li>
</ol>

				</span>
				<div class="journal-date">Published 04 September 2015</div>
				<div class="journal-tags">
				
				
	 
		<a class="tag-cont" href="/tags.html#javascript,-ref">
			<div class="tag-l"></div>
			<div class="tag-c">javascript,</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#react,-ref">
			<div class="tag-l"></div>
			<div class="tag-c">react,</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#redux,-ref">
			<div class="tag-l"></div>
			<div class="tag-c">redux,</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#react-router,-ref">
			<div class="tag-l"></div>
			<div class="tag-c">react-router,</div>
			<div class="tag-r"></div>
		</a>
	 
		<a class="tag-cont" href="/tags.html#router-ref">
			<div class="tag-l"></div>
			<div class="tag-c">router</div>
			<div class="tag-r"></div>
		</a>
	



				</div>
			</div>
		</div>
		<div class="clearboth"></div>
	</div>
</div>
	<div class="clearboth"></div>
	


  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1639110569680504";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="fb-comments" data-href="http://gameindie.github.io" data-num-posts="5" data-width="450" data-colorscheme="light"></div>



	<div class="clearboth"></div>
</div>

			</div>
			<div class="clearboth pagebottom"></div>
		</div>
	</div>
	<footer>
	<div class="footer-940">
		<div class="footer-general-info">
			© 2015 Maz.<br><br>
			Content licensed under:<br>
			<a class="cc" href="http://creativecommons.org/licenses/by-sa/3.0/">c a b</a><br>
			<a href = "/about.html">About Me</a><br>
		</div>
		<div class="footer-col-cont">
			<div class="footer-nav-col">
				<h4><a>Categories</a></h4>
				<ul>
					
					


  
     
    	<li><a href="/categories.html#chat-ref">
    		chat <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#web-ref">
    		web <span>3</span>
    	</a></li>
    
  


				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Pages</a></h4>
				<ul>
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/about.html">About Me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Feed</a></h4>
				<ul>
					<li><a href="/atom.xml">Atom Feed</a></li>
					<li><a href="/rss.xml">RSS Feed</a></li>
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a>Links</a></h4>
				<ul>
				 
					<li><a href = "http://gameindie.github.io/">Maz Studio</a></li>
				
				</ul>
			</div>
			<div class="footer-nav-col">
				<h4><a href = "/about.html">About Me</a></h4>
				<ul>
				 
					<li><a href = "mailto:gameindie.studio@gmail.com">e-mail</a></li>
				 
					<li><a href = "https://github.com/gameindie">Github</a></li>
				
				</ul>
			</div>
			<div class="clearboth"></div>
		</div>
		<div class="clearboth"></div>
	</div>
	<div class="clearboth"></div>
</footer>
	
</body>
</html>

